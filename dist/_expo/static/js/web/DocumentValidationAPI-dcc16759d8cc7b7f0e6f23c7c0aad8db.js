__d((function(g,r,i,a,m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;class t{constructor(){this.initializeMLModels()}static getInstance(){return t.instance||(t.instance=new t),t.instance}initializeMLModels(){this.ocrEngine={confidence:.95,languages:['en','af']},this.mlModel={documentClassifier:!0,fraudDetection:!0,confidenceThreshold:.8}}async validateDocument(t,n){try{const o=await this.performOCR(t),s=await this.extractStructuredData(o.text,n),c=await this.performRegistryValidations(s),u=this.calculateRiskScore(s,c),l=this.generateRecommendations(c,u);return{isValid:u<30&&'verified'===c.companyRegistration.status,confidence:o.confidence,extractedData:s,validationChecks:c,riskScore:u,recommendations:l}}catch(t){throw console.error('Document validation error:',t),new Error('Failed to validate document')}}async performOCR(t){await new Promise((t=>setTimeout(t,2e3)));const n={po_document:{text:"\n          PURCHASE ORDER\n          ABC Manufacturing (Pty) Ltd\n          Registration: 2019/123456/07\n          VAT: 4123456789\n          \n          Email: orders@abcmanufacturing.co.za\n          Phone: +27 11 123 4567\n          Address: 123 Industrial Ave, Johannesburg, 2001\n          \n          PO Number: PO-2024-001234\n          Date: 2024-01-15\n          \n          Banking Details:\n          Account: 1234567890\n          Branch: 632005\n          Bank: First National Bank\n          \n          Total Amount: R 25,750.00\n          \n          Supplier: XYZ Supplies\n          Delivery Date: 2024-01-30\n        ",confidence:.94},rfq_document:{text:"\n          REQUEST FOR QUOTATION\n          TechCorp Solutions\n          Reg No: 2020/987654/07\n          \n          Contact: procurement@techcorp.co.za\n          Tel: 021 555 0123\n          \n          RFQ-2024-0567\n          Date: 2024-01-20\n          \n          Required: IT Equipment\n          Quantity: 50 units\n          Budget: R 150,000\n          \n          Closing Date: 2024-02-05\n        ",confidence:.91},pop_document:{text:"\n          PROOF OF PAYMENT\n          \n          From: Standard Bank\n          Reference: SB240115001234\n          Date: 2024-01-15 14:32\n          \n          From Account: ****7890\n          To Account: 1234567890\n          Branch: 051001\n          \n          Amount: R 12,500.00\n          Description: Payment for Invoice INV-2024-001\n          \n          Transaction Successful\n          Balance: R 45,230.15\n        ",confidence:.96}};return n[t.includes('po')?'po_document':t.includes('rfq')?'rfq_document':'pop_document']||n.po_document}async extractStructuredData(t,n){await new Promise((t=>setTimeout(t,1500)));const o={documentType:this.classifyDocument(t)},s=t.match(/([A-Z][a-zA-Z\s&()]+(?:Pty|Ltd|CC|Inc)[^a-zA-Z]*)/);s&&(o.companyName=s[1].trim());const c=t.match(/(?:Registration|Reg\s*No|Reg):\s*(\d{4}\/\d{6}\/\d{2})/i);c&&(o.registrationNumber=c[1]);const u=t.match(/VAT:\s*(\d{10})/i);u&&(o.vatNumber=u[1]);const l=t.match(/([a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,})/);l&&(o.contactInfo={email:l[1]});const h=t.match(/Account:\s*(\d{8,12})/i),p=t.match(/Branch:\s*(\d{6})/i),f=t.match(/Bank:\s*([A-Za-z\s]+Bank[A-Za-z\s]*)/i);(h||p||f)&&(o.bankDetails={accountNumber:h?.[1],branchCode:p?.[1],bankName:f?.[1]?.trim()});const y=t.match(/(?:Amount|Total):\s*R\s*([\d,]+\.?\d*)/i);y&&(o.amount=parseFloat(y[1].replace(/,/g,'')),o.currency='ZAR');const R=t.match(/(?:Reference|Ref|PO|RFQ):\s*([A-Z0-9-]+)/i);R&&(o.reference=R[1]);const b=t.match(/Date:\s*(\d{4}-\d{2}-\d{2})/i);return b&&(o.date=b[1]),o}classifyDocument(t){const n=t.toLowerCase();return n.includes('purchase order')||n.includes('po number')?'PO':n.includes('request for quotation')||n.includes('rfq')?'RFQ':n.includes('proof of payment')||n.includes('transaction successful')?'PoP':n.includes('eft')||n.includes('electronic transfer')?'EFT':n.includes('invoice')?'Invoice':'Unknown'}async performRegistryValidations(t){await new Promise((t=>setTimeout(t,3e3)));const n={ocrQuality:.94,companyRegistration:await this.validateWithCIPC(t),domainValidation:await this.validateWithWHOIS(t),bankValidation:await this.validateWithSAFPS(t),fraudIndicators:[]};return'verified'!==n.companyRegistration.status&&n.fraudIndicators.push('Company not found in CIPC registry'),'suspicious'===n.domainValidation.status&&n.fraudIndicators.push('Domain registration suspicious'),'invalid'===n.bankValidation.status&&n.fraudIndicators.push('Invalid bank account details'),n}async validateWithCIPC(t){if(!t.companyName&&!t.registrationNumber)return{status:'error',cipciMatch:!1};const n=[{companyName:'ABC Manufacturing (Pty) Ltd',registrationNumber:'2019/123456/07',status:'active',registrationDate:'2019-03-15',directors:['John Smith','Mary Johnson']},{companyName:'TechCorp Solutions',registrationNumber:'2020/987654/07',status:'active',registrationDate:'2020-08-22',directors:['David Wilson','Sarah Brown']}].find((n=>n.companyName.toLowerCase().includes(t.companyName?.toLowerCase())||n.registrationNumber===t.registrationNumber));return n?{status:'verified',cipciMatch:!0,registrationDate:n.registrationDate,directors:n.directors}:{status:'not_found',cipciMatch:!1}}async validateWithWHOIS(t){const n=t.contactInfo?.email;if(!n)return{status:'error',whoisMatch:!1};const o=n.split('@')[1],s=[{domain:'abcmanufacturing.co.za',registrar:'ZACR',creationDate:'2019-04-01',registrantOrg:'ABC Manufacturing (Pty) Ltd'},{domain:'techcorp.co.za',registrar:'ZACR',creationDate:'2020-09-01',registrantOrg:'TechCorp Solutions'}].find((t=>t.domain===o));if(s){const t=Math.floor((Date.now()-new Date(s.creationDate).getTime())/864e5);return{status:t>90?'verified':'suspicious',whoisMatch:!0,domainAge:t,registrar:s.registrar}}return{status:'not_found',whoisMatch:!1}}async validateWithSAFPS(t){const n=t.bankDetails;if(!n?.accountNumber||!n?.branchCode)return{status:'error',safpsCheck:!1};return[{accountNumber:'1234567890',branchCode:'632005',bankName:'First National Bank',status:'active'},{accountNumber:'9876543210',branchCode:'051001',bankName:'Standard Bank',status:'active'}].find((t=>t.accountNumber===n.accountNumber&&t.branchCode===n.branchCode))?{status:'verified',safpsCheck:!0,accountExists:!0,branchValid:!0}:{status:'invalid',safpsCheck:!1,accountExists:!1,branchValid:!1}}calculateRiskScore(t,n){let o=0;return n.ocrQuality<.8?o+=20:n.ocrQuality<.9&&(o+=10),'not_found'===n.companyRegistration.status?o+=40:'suspended'===n.companyRegistration.status?o+=60:'error'===n.companyRegistration.status&&(o+=30),'suspicious'===n.domainValidation.status?o+=25:'not_found'===n.domainValidation.status&&(o+=35),'invalid'===n.bankValidation.status?o+=45:'suspicious'===n.bankValidation.status&&(o+=30),o+=15*n.fraudIndicators.length,Math.min(o,100)}generateRecommendations(t,n){const o=[];return n>70?(o.push('\ud83d\udea8 HIGH RISK: Do not proceed with transaction'),o.push('Contact customer directly using verified contact details')):n>40?(o.push('\u26a0\ufe0f MEDIUM RISK: Additional verification required'),o.push('Request additional documentation')):n>20?(o.push('\u2705 LOW RISK: Proceed with caution'),o.push('Monitor transaction closely')):o.push('\u2705 VERIFIED: Safe to proceed'),'verified'!==t.companyRegistration.status&&o.push('Verify company registration independently'),'suspicious'===t.domainValidation.status&&o.push('Domain appears recently registered - verify legitimacy'),'invalid'===t.bankValidation.status&&o.push('Bank details invalid - request correct banking information'),o}}e.default=t.getInstance()}),901,[]);